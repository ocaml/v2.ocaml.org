<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<LINK rel="stylesheet" type="text/css" href="manual.css">
<TITLE>Batch compilation (ocamlc)</TITLE>
</HEAD>
<BODY >
<A HREF="manual021.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A>
<A HREF="index.html"><IMG SRC="contents_motif.gif" ALT="Up"></A>
<A HREF="manual023.html"><IMG SRC="next_motif.gif" ALT="Next"></A>
<HR>
<H1 CLASS="chapter"><A NAME="htoc114">Chapter 8</A>  Batch compilation (ocamlc)</H1><UL>
<LI><A HREF="manual022.html#toc85">Overview of the compiler</A>
</LI><LI><A HREF="manual022.html#toc86">Options</A>
</LI><LI><A HREF="manual022.html#toc87">Modules and the file system</A>
</LI><LI><A HREF="manual022.html#toc88">Common errors</A>
</LI></UL>
<P> <A NAME="c:camlc"></A>
</P><P>This chapter describes the OCaml batch compiler <TT>ocamlc</TT>,
which compiles Caml source files to bytecode object files and links
these object files to produce standalone bytecode executable files.
These executable files are then run by the bytecode interpreter
<TT>ocamlrun</TT>.</P><H2 CLASS="section"><A NAME="toc85"></A><A NAME="htoc115">8.1</A>  Overview of the compiler</H2><P>The <TT>ocamlc</TT> command has a command-line interface similar to the one of
most C compilers. It accepts several types of arguments and processes them
sequentially:</P><UL CLASS="itemize"><LI CLASS="li-itemize">
Arguments ending in <TT>.mli</TT> are taken to be source files for
compilation unit interfaces. Interfaces specify the names exported by
compilation units: they declare value names with their types, define
public data types, declare abstract data types, and so on. From the
file <I>x</I><TT>.mli</TT>, the <TT>ocamlc</TT> compiler produces a compiled interface
in the file <I>x</I><TT>.cmi</TT>.</LI><LI CLASS="li-itemize">Arguments ending in <TT>.ml</TT> are taken to be source files for compilation
unit implementations. Implementations provide definitions for the
names exported by the unit, and also contain expressions to be
evaluated for their side-effects. From the file <I>x</I><TT>.ml</TT>, the <TT>ocamlc</TT>
compiler produces compiled object bytecode in the file <I>x</I><TT>.cmo</TT>. <P>If the interface file <I>x</I><TT>.mli</TT> exists, the implementation
<I>x</I><TT>.ml</TT> is checked against the corresponding compiled interface
<I>x</I><TT>.cmi</TT>, which is assumed to exist. If no interface
<I>x</I><TT>.mli</TT> is provided, the compilation of <I>x</I><TT>.ml</TT> produces a
compiled interface file <I>x</I><TT>.cmi</TT> in addition to the compiled
object code file <I>x</I><TT>.cmo</TT>. The file <I>x</I><TT>.cmi</TT> produced
corresponds to an interface that exports everything that is defined in
the implementation <I>x</I><TT>.ml</TT>.</P></LI><LI CLASS="li-itemize">Arguments ending in <TT>.cmo</TT> are taken to be compiled object bytecode. These
files are linked together, along with the object files obtained
by compiling <TT>.ml</TT> arguments (if any), and the OCaml standard
library, to produce a standalone executable program. The order in
which <TT>.cmo</TT> and <TT>.ml</TT> arguments are presented on the command line is
relevant: compilation units are initialized in that order at
run-time, and it is a link-time error to use a component of a unit
before having initialized it. Hence, a given <I>x</I><TT>.cmo</TT> file must come
before all <TT>.cmo</TT> files that refer to the unit <I>x</I>.</LI><LI CLASS="li-itemize">Arguments ending in <TT>.cma</TT> are taken to be libraries of object bytecode.
A library of object bytecode packs in a single file a set of object
bytecode files (<TT>.cmo</TT> files). Libraries are built with <TT>ocamlc -a</TT>
(see the description of the <TT>-a</TT> option below). The object files
contained in the library are linked as regular <TT>.cmo</TT> files (see
above), in the order specified when the <TT>.cma</TT> file was built. The
only difference is that if an object file contained in a library is
not referenced anywhere in the program, then it is not linked in.</LI><LI CLASS="li-itemize">Arguments ending in <TT>.c</TT> are passed to the C compiler, which generates
a <TT>.o</TT> object file (<TT>.obj</TT> under Windows). This object file is linked
with the program if the <TT>-custom</TT> flag is set (see the description of
<TT>-custom</TT> below).</LI><LI CLASS="li-itemize">Arguments ending in <TT>.o</TT> or <TT>.a</TT> (<TT>.obj</TT> or <TT>.lib</TT> under Windows)
are assumed to be C object files and libraries. They are passed to the
C linker when linking in <TT>-custom</TT> mode (see the description of
<TT>-custom</TT> below).</LI><LI CLASS="li-itemize">Arguments ending in <TT>.so</TT> (<TT>.dll</TT> under Windows)
are assumed to be C shared libraries (DLLs). During linking, they are
searched for external C functions referenced from the Caml code,
and their names are written in the generated bytecode executable.
The run-time system <TT>ocamlrun</TT> then loads them dynamically at program
start-up time.</LI></UL><P>The output of the linking phase is a file containing compiled bytecode
that can be executed by the OCaml bytecode interpreter:
the command named <TT>ocamlrun</TT>. If <TT>caml.out</TT> is the name of the file
produced by the linking phase, the command
</P><PRE>
        ocamlrun caml.out <I>arg</I><SUB>1</SUB> <I>arg</I><SUB>2</SUB> &#X2026; <I>arg<SUB>n</SUB></I>
</PRE><P>
executes the compiled code contained in <TT>caml.out</TT>, passing it as
arguments the character strings <I>arg</I><SUB>1</SUB> to <I>arg<SUB>n</SUB></I>.
(See chapter <A HREF="manual024.html#c:runtime">10</A> for more details.)</P><P>On most systems, the file produced by the linking
phase can be run directly, as in:
</P><PRE>
        ./caml.out <I>arg</I><SUB>1</SUB> <I>arg</I><SUB>2</SUB> &#X2026; <I>arg<SUB>n</SUB></I>
</PRE><P>
The produced file has the executable bit set, and it manages to launch
the bytecode interpreter by itself.</P><H2 CLASS="section"><A NAME="toc86"></A><A NAME="htoc116">8.2</A>  Options</H2><P><A NAME="s:comp-options"></A></P><P>The following command-line options are recognized by <TT>ocamlc</TT>.
The options <TT>-pack</TT>, <TT>-a</TT>, <TT>-c</TT> and <TT>-output-obj</TT> are mutually exclusive.</P><DL CLASS="description"><DT CLASS="dt-description"><TT><B>-a</B></TT></DT><DD CLASS="dd-description">
Build a library (<TT>.cma</TT> file) with the object files (<TT>.cmo</TT> files)
given on the command line, instead of linking them into an executable
file. The name of the library must be set with the <TT>-o</TT> option.<P>If <TT>-custom</TT>, <TT>-cclib</TT> or <TT>-ccopt</TT> options are passed on the command
line, these options are stored in the resulting <TT>.cma</TT> library. Then,
linking with this library automatically adds back the <TT>-custom</TT>,
<TT>-cclib</TT> and <TT>-ccopt</TT> options as if they had been provided on the
command line, unless the <TT>-noautolink</TT> option is given.</P></DD><DT CLASS="dt-description"><TT><B>-annot</B></TT></DT><DD CLASS="dd-description">
Dump detailed information about the compilation (types, bindings,
tail-calls, etc). The information for file <I>src</I><TT>.ml</TT>
is put into file <I>src</I><TT>.annot</TT>. In case of a type error, dump
all the information inferred by the type-checker before the error.
The <I>src</I><TT>.annot</TT> file can be used with the emacs commands given in
<TT>emacs/caml-types.el</TT> to display types and other annotations
interactively.</DD><DT CLASS="dt-description"><TT><B>-c</B></TT></DT><DD CLASS="dd-description">
Compile only. Suppress the linking phase of the
compilation. Source code files are turned into compiled files, but no
executable file is produced. This option is useful to
compile modules separately.</DD><DT CLASS="dt-description"><B><TT>-cc</TT> <I>ccomp</I></B></DT><DD CLASS="dd-description">
Use <I>ccomp</I> as the C linker when linking in &#X201C;custom runtime&#X201D;
mode (see the <TT>-custom</TT> option)
and as the C compiler for compiling <TT>.c</TT> source files.</DD><DT CLASS="dt-description"><B><TT>-cclib</TT> <TT>-l</TT><I>libname</I></B></DT><DD CLASS="dd-description">
Pass the <TT>-l</TT><I>libname</I> option to the C linker when linking in
&#X201C;custom runtime&#X201D; mode (see the <TT>-custom</TT> option). This causes the
given C library to be linked with the program.</DD><DT CLASS="dt-description"><B><TT>-ccopt</TT> <I>option</I></B></DT><DD CLASS="dd-description">
Pass the given option to the C compiler and linker. When linking in
&#X201C;custom runtime&#X201D; mode, for instance,
<TT>-ccopt -L</TT><I>dir</I> causes the C linker to search for C libraries in
directory <I>dir</I>. (See the <TT>-custom</TT> option.) </DD><DT CLASS="dt-description"><TT><B>-config</B></TT></DT><DD CLASS="dd-description">
Print the version number of <TT>ocamlc</TT> and a detailed summary of its
configuration, then exit.</DD><DT CLASS="dt-description"><TT><B>-custom</B></TT></DT><DD CLASS="dd-description">
Link in &#X201C;custom runtime&#X201D; mode. In the default linking mode, the
linker produces bytecode that is intended to be executed with the
shared runtime system, <TT>ocamlrun</TT>. In the custom runtime mode, the
linker produces an output file that contains both the runtime system
and the bytecode for the program. The resulting file is larger, but it
can be executed directly, even if the <TT>ocamlrun</TT> command is not
installed. Moreover, the &#X201C;custom runtime&#X201D; mode enables static
linking of Caml code with user-defined C functions, as described in
chapter <A HREF="manual032.html#c:intf-c">18</A>.
<BLOCKQUOTE CLASS="quote"><FONT COLOR=purple>Unix:</FONT>  
Never use the <TT>strip</TT> command on executables produced by <TT>ocamlc -custom</TT>,
this would remove the bytecode part of the executable.
</BLOCKQUOTE></DD><DT CLASS="dt-description"><B><TT>-dllib</TT> <TT>-l</TT><I>libname</I></B></DT><DD CLASS="dd-description">
Arrange for the C shared library <TT>dll</TT><I>libname</I><TT>.so</TT>
(<TT>dll</TT><I>libname</I><TT>.dll</TT> under Windows) to be loaded dynamically
by the run-time system <TT>ocamlrun</TT> at program start-up time.</DD><DT CLASS="dt-description"><B><TT>-dllpath</TT> <I>dir</I></B></DT><DD CLASS="dd-description">
Adds the directory <I>dir</I> to the run-time search path for shared
C libraries. At link-time, shared libraries are searched in the
standard search path (the one corresponding to the <TT>-I</TT> option).
The <TT>-dllpath</TT> option simply stores <I>dir</I> in the produced
executable file, where <TT>ocamlrun</TT> can find it and use it as
described in section <A HREF="manual024.html#s-ocamlrun-dllpath">10.3</A>.</DD><DT CLASS="dt-description"><TT><B>-g</B></TT></DT><DD CLASS="dd-description">
Add debugging information while compiling and linking. This option is
required in order to be able to debug the program with <TT>ocamldebug</TT>
(see chapter <A HREF="manual030.html#c:debugger">16</A>), and to produce stack backtraces when
the program terminates on an uncaught exception (see
section <A HREF="manual024.html#ocamlrun-options">10.2</A>).</DD><DT CLASS="dt-description"><TT><B>-help-warnings</B></TT></DT><DD CLASS="dd-description">
Show description for all available warning numbers.</DD><DT CLASS="dt-description"><TT><B>-i</B></TT></DT><DD CLASS="dd-description">
Cause the compiler to print all defined names (with their inferred
types or their definitions) when compiling an implementation (<TT>.ml</TT>
file). No compiled files (<TT>.cmo</TT> and <TT>.cmi</TT> files) are produced.
This can be useful to check the types inferred by the
compiler. Also, since the output follows the syntax of interfaces, it
can help in writing an explicit interface (<TT>.mli</TT> file) for a file:
just redirect the standard output of the compiler to a <TT>.mli</TT> file,
and edit that file to remove all declarations of unexported names.</DD><DT CLASS="dt-description"><B><TT>-I</TT> <I>directory</I></B></DT><DD CLASS="dd-description">
Add the given directory to the list of directories searched for
compiled interface files (<TT>.cmi</TT>), compiled object code files
(<TT>.cmo</TT>), libraries (<TT>.cma</TT>), and C libraries specified with
<TT>-cclib -lxxx</TT>. By default, the current directory is
searched first, then the standard library directory. Directories added
with <TT>-I</TT> are searched after the current directory, in the order in
which they were given on the command line, but before the standard
library directory.<P>If the given directory starts with <TT>+</TT>, it is taken relative to the
standard library directory. For instance, <TT>-I +labltk</TT> adds the
subdirectory <TT>labltk</TT> of the standard library to the search path.</P></DD><DT CLASS="dt-description"><B><TT>-impl</TT> <I>filename</I></B></DT><DD CLASS="dd-description">
Compile the file <I>filename</I> as an implementation file, even if its
extension is not <TT>.ml</TT>.</DD><DT CLASS="dt-description"><B><TT>-intf</TT> <I>filename</I></B></DT><DD CLASS="dd-description">
Compile the file <I>filename</I> as an interface file, even if its
extension is not <TT>.mli</TT>.</DD><DT CLASS="dt-description"><B><TT>-intf-suffix</TT> <I>string</I></B></DT><DD CLASS="dd-description">
Recognize file names ending with <I>string</I> as interface files
(instead of the default <TT>.mli</TT>).</DD><DT CLASS="dt-description"><TT><B>-labels</B></TT></DT><DD CLASS="dd-description">
Labels are not ignored in types, labels may be used in applications,
and labelled parameters can be given in any order. This is the default.</DD><DT CLASS="dt-description"><TT><B>-linkall</B></TT></DT><DD CLASS="dd-description">
Force all modules contained in libraries to be linked in. If this
flag is not given, unreferenced modules are not linked in. When
building a library (option <TT>-a</TT>), setting the <TT>-linkall</TT> option forces all
subsequent links of programs involving that library to link all the
modules contained in the library.</DD><DT CLASS="dt-description"><TT><B>-make-runtime</B></TT></DT><DD CLASS="dd-description">
Build a custom runtime system (in the file specified by option <TT>-o</TT>)
incorporating the C object files and libraries given on the command
line. This custom runtime system can be used later to execute
bytecode executables produced with the
<TT>ocamlc -use-runtime</TT> <I>runtime-name</I> option.
See section <A HREF="manual032.html#s:custom-runtime">18.1.6</A> for more information.</DD><DT CLASS="dt-description"><TT><B>-noassert</B></TT></DT><DD CLASS="dd-description">
Do not compile assertion checks. Note that the special form
<TT>assert false</TT> is always compiled because it is typed specially.
This flag has no effect when linking already-compiled files.</DD><DT CLASS="dt-description"><TT><B>-noautolink</B></TT></DT><DD CLASS="dd-description">
When linking <TT>.cma</TT> libraries, ignore <TT>-custom</TT>, <TT>-cclib</TT> and <TT>-ccopt</TT>
options potentially contained in the libraries (if these options were
given when building the libraries). This can be useful if a library
contains incorrect specifications of C libraries or C options; in this
case, during linking, set <TT>-noautolink</TT> and pass the correct C
libraries and options on the command line.</DD><DT CLASS="dt-description"><TT><B>-nolabels</B></TT></DT><DD CLASS="dd-description">
Ignore non-optional labels in types. Labels cannot be used in
applications, and parameter order becomes strict.</DD><DT CLASS="dt-description"><B><TT>-o</TT> <I>exec-file</I></B></DT><DD CLASS="dd-description">
Specify the name of the output file produced by the compiler. The
default output name is <TT>a.out</TT> under Unix and <TT>camlprog.exe</TT> under
Windows. If the <TT>-a</TT> option is given, specify the name of the library
produced. If the <TT>-pack</TT> option is given, specify the name of the
packed object file produced. If the <TT>-output-obj</TT> option is given,
specify the name of the output file produced. If the <TT>-c</TT> option is
given, specify the name of the object file produced for the <EM>next</EM>
source file that appears on the command line.</DD><DT CLASS="dt-description"><TT><B>-output-obj</B></TT></DT><DD CLASS="dd-description">
Cause the linker to produce a C object file instead of a bytecode
executable file. This is useful to wrap Caml code as a C library,
callable from any C program. See chapter <A HREF="manual032.html#c:intf-c">18</A>,
section <A HREF="manual032.html#s:embedded-code">18.7.5</A>. The name of the output object file is
<TT>camlprog.o</TT> by default; it can be set with the <TT>-o</TT> option. This
option can also be used to produce a C source file (<TT>.c</TT> extension) or
a compiled shared/dynamic library (<TT>.so</TT> extension, <TT>.dll</TT> under Windows).</DD><DT CLASS="dt-description"><TT><B>-pack</B></TT></DT><DD CLASS="dd-description">
Build a bytecode object file (<TT>.cmo</TT> file) and its associated compiled
interface (<TT>.cmi</TT>) that combines the object
files given on the command line, making them appear as sub-modules of
the output <TT>.cmo</TT> file. The name of the output <TT>.cmo</TT> file must be
given with the <TT>-o</TT> option. For instance,
<PRE CLASS="verbatim">        ocamlc -pack -o p.cmo a.cmo b.cmo c.cmo
</PRE>generates compiled files <TT>p.cmo</TT> and <TT>p.cmi</TT> describing a compilation
unit having three sub-modules <TT>A</TT>, <TT>B</TT> and <TT>C</TT>, corresponding to the
contents of the object files <TT>a.cmo</TT>, <TT>b.cmo</TT> and <TT>c.cmo</TT>. These
contents can be referenced as <TT>P.A</TT>, <TT>P.B</TT> and <TT>P.C</TT> in the remainder
of the program.</DD><DT CLASS="dt-description"><B><TT>-pp</TT> <I>command</I></B></DT><DD CLASS="dd-description">
Cause the compiler to call the given <I>command</I> as a preprocessor
for each source file. The output of <I>command</I> is redirected to
an intermediate file, which is compiled. If there are no compilation
errors, the intermediate file is deleted afterwards.</DD><DT CLASS="dt-description"><TT><B>-principal</B></TT></DT><DD CLASS="dd-description">
Check information path during type-checking, to make sure that all
types are derived in a principal way. When using labelled arguments
and/or polymorphic methods, this flag is required to ensure future
versions of the compiler will be able to infer types correctly, even
if internal algorithms change.
All programs accepted in <TT>-principal</TT> mode are also accepted in the
default mode with equivalent types, but different binary signatures,
and this may slow down type checking; yet it is a good idea to
use it once before publishing source code.</DD><DT CLASS="dt-description"><TT><B>-rectypes</B></TT></DT><DD CLASS="dd-description">
Allow arbitrary recursive types during type-checking. By default,
only recursive types where the recursion goes through an object type
are supported. Note that once you have created an interface using this
flag, you must use it again for all dependencies.</DD><DT CLASS="dt-description"><B><TT>-runtime-variant</TT> <I>suffix</I></B></DT><DD CLASS="dd-description">
Add the <I>suffix</I> string to the name of the runtime library used by
the program. Currently, only one such suffix is supported: <TT>d</TT>, and
only if the OCaml compiler was configured with option
<TT>-with-debug-runtime</TT>. This suffix gives the debug version of the
runtime, which is useful for debugging pointer problems in low-level
code such as C stubs.</DD><DT CLASS="dt-description"><TT><B>-thread</B></TT></DT><DD CLASS="dd-description">
Compile or link multithreaded programs, in combination with the
system <TT>threads</TT> library described in chapter <A HREF="manual038.html#c:threads">24</A>.</DD><DT CLASS="dt-description"><TT><B>-unsafe</B></TT></DT><DD CLASS="dd-description">
Turn bound checking off for array and string accesses (the <TT>v.(i)</TT> and
<TT>s.[i]</TT> constructs). Programs compiled with <TT>-unsafe</TT> are therefore
slightly faster, but unsafe: anything can happen if the program
accesses an array or string outside of its bounds.</DD><DT CLASS="dt-description"><B><TT>-use-runtime</TT> <I>runtime-name</I></B></DT><DD CLASS="dd-description">
Generate a bytecode executable file that can be executed on the custom
runtime system <I>runtime-name</I>, built earlier with
<TT>ocamlc -make-runtime</TT> <I>runtime-name</I>. 
See section <A HREF="manual032.html#s:custom-runtime">18.1.6</A> for more information.</DD><DT CLASS="dt-description"><TT><B>-v</B></TT></DT><DD CLASS="dd-description">
Print the version number of the compiler and the location of the
standard library directory, then exit.</DD><DT CLASS="dt-description"><TT><B>-verbose</B></TT></DT><DD CLASS="dd-description">
Print all external commands before they are executed, in particular
invocations of the C compiler and linker in <TT>-custom</TT> mode. Useful to
debug C library problems.</DD><DT CLASS="dt-description"><B><TT>-vnum</TT> or <TT>-version</TT></B></DT><DD CLASS="dd-description">
Print the version number of the compiler in short form (e.g. <TT>3.11.0</TT>),
then exit.</DD><DT CLASS="dt-description"><TT><B>-vmthread</B></TT></DT><DD CLASS="dd-description">
Compile or link multithreaded programs, in combination with the
VM-level <TT>threads</TT> library described in chapter <A HREF="manual038.html#c:threads">24</A>.</DD><DT CLASS="dt-description"><B><TT>-w</TT> <I>warning-list</I></B></DT><DD CLASS="dd-description">
Enable, disable, or mark as errors the warnings specified by the argument
<I>warning-list</I>.
Each warning can be <EM>enabled</EM> or <EM>disabled</EM>, and each warning
can be <EM>marked</EM> or <EM>unmarked</EM>.
If a warning is disabled, it isn&#X2019;t displayed and doesn&#X2019;t affect
compilation in any way (even if it is marked). If a warning is
enabled, it is displayed normally by the compiler whenever the source
code triggers it. If it is enabled and marked, the compiler will stop
with an error after displaying that warning if the source code
triggers it.<P>The <I>warning-list</I> argument is a sequence of warning specifiers,
with no separators between them. A warning specifier is one of the
following:</P><DL CLASS="description"><DT CLASS="dt-description">
<B><TT>+</TT><I>num</I></B></DT><DD CLASS="dd-description"> Enable warning number <I>num</I>.
</DD><DT CLASS="dt-description"><B><TT>-</TT><I>num</I></B></DT><DD CLASS="dd-description"> Disable warning number <I>num</I>.
</DD><DT CLASS="dt-description"><B><TT>@</TT><I>num</I></B></DT><DD CLASS="dd-description"> Enable and mark warning number <I>num</I>.
</DD><DT CLASS="dt-description"><B><TT>+</TT><I>num1</I>..<I>num2</I></B></DT><DD CLASS="dd-description"> Enable warnings in the given range.
</DD><DT CLASS="dt-description"><B><TT>-</TT><I>num1</I>..<I>num2</I></B></DT><DD CLASS="dd-description"> Disable warnings in the given range.
</DD><DT CLASS="dt-description"><B><TT>@</TT><I>num1</I>..<I>num2</I></B></DT><DD CLASS="dd-description"> Enable and mark warnings in the given range.
</DD><DT CLASS="dt-description"><B><TT>+</TT><I>letter</I></B></DT><DD CLASS="dd-description"> Enable the set of warnings corresponding to
<I>letter</I>. The letter may be uppercase or lowercase.
</DD><DT CLASS="dt-description"><B><TT>-</TT><I>letter</I></B></DT><DD CLASS="dd-description"> Disable the set of warnings corresponding to
<I>letter</I>. The letter may be uppercase or lowercase.
</DD><DT CLASS="dt-description"><B><TT>@</TT><I>letter</I></B></DT><DD CLASS="dd-description"> Enable and mark the set of warnings
corresponding to <I>letter</I>. The letter may be uppercase or
lowercase.
</DD><DT CLASS="dt-description"><I><B>uppercase-letter</B></I></DT><DD CLASS="dd-description"> Enable the set of warnings corresponding
to <I>uppercase-letter</I>.
</DD><DT CLASS="dt-description"><I><B>lowercase-letter</B></I></DT><DD CLASS="dd-description"> Disable the set of warnings corresponding
to <I>lowercase-letter</I>.
</DD></DL><P>Warning numbers which are out of the range of warnings that are currently
defined are ignored. The warning numbers are as follows.
</P><DL CLASS="description"><DT CLASS="dt-description">
<B>1</B></DT><DD CLASS="dd-description"> Suspicious-looking start-of-comment mark.
</DD><DT CLASS="dt-description"><B>2</B></DT><DD CLASS="dd-description"> Suspicious-looking end-of-comment mark.
</DD><DT CLASS="dt-description"><B>3</B></DT><DD CLASS="dd-description"> Deprecated syntax.
</DD><DT CLASS="dt-description"><B>4</B></DT><DD CLASS="dd-description"> Fragile pattern matching: matching that will remain complete even
if additional constructors are added to one of the variant types
matched.
</DD><DT CLASS="dt-description"><B>5</B></DT><DD CLASS="dd-description"> Partially applied function: expression whose result has function
type and is ignored.
</DD><DT CLASS="dt-description"><B>6</B></DT><DD CLASS="dd-description"> Label omitted in function application.
</DD><DT CLASS="dt-description"><B>7</B></DT><DD CLASS="dd-description"> Some methods are overridden in the class where they are defined.
</DD><DT CLASS="dt-description"><B>8</B></DT><DD CLASS="dd-description"> Partial match: missing cases in pattern-matching.
</DD><DT CLASS="dt-description"><B>9</B></DT><DD CLASS="dd-description"> Missing fields in a record pattern.
</DD><DT CLASS="dt-description"><B>10</B></DT><DD CLASS="dd-description"> Expression on the left-hand side of a sequence that doesn&#X2019;t have type
"unit" (and that is not a function, see warning number 5).
</DD><DT CLASS="dt-description"><B>11</B></DT><DD CLASS="dd-description"> Redundant case in a pattern matching (unused match case).
</DD><DT CLASS="dt-description"><B>12</B></DT><DD CLASS="dd-description"> Redundant sub-pattern in a pattern-matching.
</DD><DT CLASS="dt-description"><B>13</B></DT><DD CLASS="dd-description"> Override of an instance variable.
</DD><DT CLASS="dt-description"><B>14</B></DT><DD CLASS="dd-description"> Illegal backslash escape in a string constant.
</DD><DT CLASS="dt-description"><B>15</B></DT><DD CLASS="dd-description"> Private method made public implicitly.
</DD><DT CLASS="dt-description"><B>16</B></DT><DD CLASS="dd-description"> Unerasable optional argument.
</DD><DT CLASS="dt-description"><B>17</B></DT><DD CLASS="dd-description"> Undeclared virtual method.
</DD><DT CLASS="dt-description"><B>18</B></DT><DD CLASS="dd-description"> Non-principal type.
</DD><DT CLASS="dt-description"><B>19</B></DT><DD CLASS="dd-description"> Type without principality.
</DD><DT CLASS="dt-description"><B>20</B></DT><DD CLASS="dd-description"> Unused function argument.
</DD><DT CLASS="dt-description"><B>21</B></DT><DD CLASS="dd-description"> Non-returning statement.
</DD><DT CLASS="dt-description"><B>22</B></DT><DD CLASS="dd-description"> Camlp4 warning.
</DD><DT CLASS="dt-description"><B>23</B></DT><DD CLASS="dd-description"> Useless record "with" clause.
</DD><DT CLASS="dt-description"><B>24</B></DT><DD CLASS="dd-description"> Bad module name: the source file name is not a valid OCaml module name.
</DD><DT CLASS="dt-description"><B>25</B></DT><DD CLASS="dd-description"> Pattern-matching with all clauses guarded. Exhaustiveness cannot be
checked
</DD><DT CLASS="dt-description"><B>26</B></DT><DD CLASS="dd-description"> Suspicious unused variable: unused variable that is bound with "let"
or "as", and doesn&#X2019;t start with an underscore ("_") character.
</DD><DT CLASS="dt-description"><B>27</B></DT><DD CLASS="dd-description"> Innocuous unused variable: unused variable that is not bound with
"let" nor "as", and doesn&#X2019;t start with an underscore ("_")
character.
</DD><DT CLASS="dt-description"><B>28</B></DT><DD CLASS="dd-description"> Wildcard pattern given as argument to a constant constructor.
</DD><DT CLASS="dt-description"><B>29</B></DT><DD CLASS="dd-description"> Unescaped end-of-line in a string constant (non-portable code).
</DD><DT CLASS="dt-description"><B>30</B></DT><DD CLASS="dd-description"> Two labels or constructors of the same name are defined in two
mutually recursive types.

</DD></DL><P>The letters stand for the following sets of warnings. Any letter not
mentioned here corresponds to the empty set.</P><DL CLASS="description"><DT CLASS="dt-description">
<B>A</B></DT><DD CLASS="dd-description"> all warnings
</DD><DT CLASS="dt-description"><B>C</B></DT><DD CLASS="dd-description"> 1, 2
</DD><DT CLASS="dt-description"><B>D</B></DT><DD CLASS="dd-description"> 3
</DD><DT CLASS="dt-description"><B>E</B></DT><DD CLASS="dd-description"> 4
</DD><DT CLASS="dt-description"><B>F</B></DT><DD CLASS="dd-description"> 5
</DD><DT CLASS="dt-description"><B>L</B></DT><DD CLASS="dd-description"> 6
</DD><DT CLASS="dt-description"><B>M</B></DT><DD CLASS="dd-description"> 7
</DD><DT CLASS="dt-description"><B>P</B></DT><DD CLASS="dd-description"> 8
</DD><DT CLASS="dt-description"><B>R</B></DT><DD CLASS="dd-description"> 9
</DD><DT CLASS="dt-description"><B>S</B></DT><DD CLASS="dd-description"> 10
</DD><DT CLASS="dt-description"><B>U</B></DT><DD CLASS="dd-description"> 11, 12
</DD><DT CLASS="dt-description"><B>V</B></DT><DD CLASS="dd-description"> 13
</DD><DT CLASS="dt-description"><B>X</B></DT><DD CLASS="dd-description"> 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25
</DD><DT CLASS="dt-description"><B>Y</B></DT><DD CLASS="dd-description"> 26
</DD><DT CLASS="dt-description"><B>Z</B></DT><DD CLASS="dd-description"> 27
</DD></DL><P>The default setting is <TT>-w +a-4-6-7-9-27..29</TT>.
Note that warnings 5 and 10 are not always triggered, depending on
the internals of the type checker.</P></DD><DT CLASS="dt-description"><B><TT>-warn-error</TT> <I>warning-list</I></B></DT><DD CLASS="dd-description">
Mark as errors the warnings specified in the argument <I>warning-list</I>.
The compiler will stop with an error when one of these warnings is
emitted. The <I>warning-list</I> has the same meaning as for
the <TT>-w</TT> option: a <TT>+</TT> sign (or an uppercase letter) turns the
corresponding warnings into errors, a <TT>-</TT>
sign (or a lowercase letter) turns them back into warnings, and a
<TT>@</TT> sign both enables and marks the corresponding warnings.<P>Note: it is not recommended to use warning sets (i.e. letters) as
arguments to <TT>-warn-error</TT>
in production code, because this can break your build when future versions
of OCaml add some new warnings.</P><P>The default setting is <TT>-warn-error -a</TT>
(none of the warnings is treated as an error).</P></DD><DT CLASS="dt-description"><TT><B>-where</B></TT></DT><DD CLASS="dd-description">
Print the location of the standard library, then exit.</DD><DT CLASS="dt-description"><B><TT>-</TT> <I>file</I></B></DT><DD CLASS="dd-description">
Process <I>file</I> as a file name, even if it starts with a dash (-)
character.</DD><DT CLASS="dt-description"><B><TT>-help</TT> or <TT>--help</TT></B></DT><DD CLASS="dd-description">
Display a short usage summary and exit.
</DD></DL><H2 CLASS="section"><A NAME="toc87"></A><A NAME="htoc117">8.3</A>  Modules and the file system</H2><P>This short section is intended to clarify the relationship between the
names of the modules corresponding to compilation units and the names
of the files that contain their compiled interface and compiled
implementation.</P><P>The compiler always derives the module name by taking the capitalized
base name of the source file (<TT>.ml</TT> or <TT>.mli</TT> file). That is, it
strips the leading directory name, if any, as well as the <TT>.ml</TT> or
<TT>.mli</TT> suffix; then, it set the first letter to uppercase, in order to
comply with the requirement that module names must be capitalized.
For instance, compiling the file <TT>mylib/misc.ml</TT> provides an
implementation for the module named <TT>Misc</TT>. Other compilation units
may refer to components defined in <TT>mylib/misc.ml</TT> under the names
<TT>Misc.</TT><I>name</I>; they can also do <TT>open Misc</TT>, then use unqualified
names <I>name</I>.</P><P>The <TT>.cmi</TT> and <TT>.cmo</TT> files produced by the compiler have the same
base name as the source file. Hence, the compiled files always have
their base name equal (modulo capitalization of the first letter) to
the name of the module they describe (for <TT>.cmi</TT> files) or implement
(for <TT>.cmo</TT> files).</P><P>When the compiler encounters a reference to a free module identifier
<TT>Mod</TT>, it looks in the search path for a file named <TT>Mod.cmi</TT> or <TT>mod.cmi</TT>
and loads the compiled interface
contained in that file. As a consequence, renaming <TT>.cmi</TT> files is not
advised: the name of a <TT>.cmi</TT> file must always correspond to the name
of the compilation unit it implements. It is admissible to move them
to another directory, if their base name is preserved, and the correct
<TT>-I</TT> options are given to the compiler. The compiler will flag an
error if it loads a <TT>.cmi</TT> file that has been renamed.</P><P>Compiled bytecode files (<TT>.cmo</TT> files), on the other hand, can be
freely renamed once created. That&#X2019;s because the linker never attempts
to find by itself the <TT>.cmo</TT> file that implements a module with a
given name: it relies instead on the user providing the list of <TT>.cmo</TT>
files by hand.</P><H2 CLASS="section"><A NAME="toc88"></A><A NAME="htoc118">8.4</A>  Common errors</H2><P> <A NAME="s:comp-errors"></A></P><P>This section describes and explains the most frequently encountered
error messages.</P><DL CLASS="description"><DT CLASS="dt-description"><B>Cannot find file <I>filename</I></B></DT><DD CLASS="dd-description">
The named file could not be found in the current directory, nor in the
directories of the search path. The <I>filename</I> is either a
compiled interface file (<TT>.cmi</TT> file), or a compiled bytecode file
(<TT>.cmo</TT> file). If <I>filename</I> has the format <I>mod</I><TT>.cmi</TT>, this
means you are trying to compile a file that references identifiers
from module <I>mod</I>, but you have not yet compiled an interface for
module <I>mod</I>. Fix: compile <I>mod</I><TT>.mli</TT> or <I>mod</I><TT>.ml</TT>
first, to create the compiled interface <I>mod</I><TT>.cmi</TT>. <P>If <I>filename</I> has the format <I>mod</I><TT>.cmo</TT>, this
means you are trying to link a bytecode object file that does not
exist yet. Fix: compile <I>mod</I><TT>.ml</TT> first.</P><P>If your program spans several directories, this error can also appear
because you haven&#X2019;t specified the directories to look into. Fix: add
the correct <TT>-I</TT> options to the command line.</P></DD><DT CLASS="dt-description"><B>Corrupted compiled interface <I>filename</I></B></DT><DD CLASS="dd-description">
The compiler produces this error when it tries to read a compiled
interface file (<TT>.cmi</TT> file) that has the wrong structure. This means
something went wrong when this <TT>.cmi</TT> file was written: the disk was
full, the compiler was interrupted in the middle of the file creation,
and so on. This error can also appear if a <TT>.cmi</TT> file is modified after
its creation by the compiler. Fix: remove the corrupted <TT>.cmi</TT> file,
and rebuild it.</DD><DT CLASS="dt-description"><B>This expression has type <I>t</I><SUB>1</SUB>, but is used with type <I>t</I><SUB>2</SUB></B></DT><DD CLASS="dd-description">
This is by far the most common type error in programs. Type <I>t</I><SUB>1</SUB> is
the type inferred for the expression (the part of the program that is
displayed in the error message), by looking at the expression itself.
Type <I>t</I><SUB>2</SUB> is the type expected by the context of the expression; it
is deduced by looking at how the value of this expression is used in
the rest of the program. If the two types <I>t</I><SUB>1</SUB> and <I>t</I><SUB>2</SUB> are not
compatible, then the error above is produced.<P>In some cases, it is hard to understand why the two types <I>t</I><SUB>1</SUB> and
<I>t</I><SUB>2</SUB> are incompatible. For instance, the compiler can report that
&#X201C;expression of type <TT>foo</TT> cannot be used with type <TT>foo</TT>&#X201D;, and it
really seems that the two types <TT>foo</TT> are compatible. This is not
always true. Two type constructors can have the same name, but
actually represent different types. This can happen if a type
constructor is redefined. Example:
</P><PRE CLASS="verbatim">        type foo = A | B
        let f = function A -&gt; 0 | B -&gt; 1
        type foo = C | D
        f C
</PRE><P>This result in the error message &#X201C;expression <TT>C</TT> of type <TT>foo</TT> cannot
be used with type <TT>foo</TT>&#X201D;. </P></DD><DT CLASS="dt-description"><B>The type of this expression, <I>t</I>, contains type variables
that cannot be generalized</B></DT><DD CLASS="dd-description">
Type variables (<TT>&#X2019;a</TT>, <TT>&#X2019;b</TT>, &#X2026;) in a type <I>t</I> can be in either
of two states: generalized (which means that the type <I>t</I> is valid
for all possible instantiations of the variables) and not generalized
(which means that the type <I>t</I> is valid only for one instantiation
of the variables). In a <TT>let</TT> binding <TT>let </TT><I>name</I><TT> = </TT><I>expr</I>,
the type-checker normally generalizes as many type variables as
possible in the type of <I>expr</I>. However, this leads to unsoundness
(a well-typed program can crash) in conjunction with polymorphic
mutable data structures. To avoid this, generalization is performed at
<TT>let</TT> bindings only if the bound expression <I>expr</I> belongs to the
class of &#X201C;syntactic values&#X201D;, which includes constants, identifiers,
functions, tuples of syntactic values, etc. In all other cases (for
instance, <I>expr</I> is a function application), a polymorphic mutable
could have been created and generalization is therefore turned off for
all variables occuring in contravariant or non-variant branches of the
type. For instance, if the type of a non-value is <TT>&#X2019;a list</TT> the
variable is generalizable (<TT>list</TT> is a covariant type constructor),
but not in <TT>&#X2019;a list -&gt; &#X2019;a list</TT> (the left branch of <TT>-&gt;</TT> is
contravariant) or <TT>&#X2019;a ref</TT> (<TT>ref</TT> is non-variant).<P>Non-generalized type variables in a type cause no difficulties inside
a given structure or compilation unit (the contents of a <TT>.ml</TT> file,
or an interactive session), but they cannot be allowed inside
signatures nor in compiled interfaces (<TT>.cmi</TT> file), because they
could be used inconsistently later. Therefore, the compiler
flags an error when a structure or compilation unit defines a value
<I>name</I> whose type contains non-generalized type variables. There
are two ways to fix this error:
</P><UL CLASS="itemize"><LI CLASS="li-itemize">
Add a type constraint or a <TT>.mli</TT> file to give a monomorphic
type (without type variables) to <I>name</I>. For instance, instead of
writing
<PRE CLASS="verbatim">    let sort_int_list = Sort.list (&lt;)
    (* inferred type 'a list -&gt; 'a list, with 'a not generalized *)
</PRE>write
<PRE CLASS="verbatim">    let sort_int_list = (Sort.list (&lt;) : int list -&gt; int list);;
</PRE></LI><LI CLASS="li-itemize">If you really need <I>name</I> to have a polymorphic type, turn
its defining expression into a function by adding an extra parameter.
For instance, instead of writing
<PRE CLASS="verbatim">    let map_length = List.map Array.length
    (* inferred type 'a array list -&gt; int list, with 'a not generalized *)
</PRE>write
<PRE CLASS="verbatim">    let map_length lv = List.map Array.length lv
</PRE></LI></UL></DD><DT CLASS="dt-description"><B>Reference to undefined global <I>mod</I></B></DT><DD CLASS="dd-description">
This error appears when trying to link an incomplete or incorrectly
ordered set of files. Either you have forgotten to provide an
implementation for the compilation unit named <I>mod</I> on the command line
(typically, the file named <I>mod</I><TT>.cmo</TT>, or a library containing
that file). Fix: add the missing <TT>.ml</TT> or <TT>.cmo</TT> file to the command
line. Or, you have provided an implementation for the module named
<I>mod</I>, but it comes too late on the command line: the
implementation of <I>mod</I> must come before all bytecode object files
that reference <I>mod</I>. Fix: change the order of <TT>.ml</TT> and <TT>.cmo</TT>
files on the command line.<P>Of course, you will always encounter this error if you have mutually
recursive functions across modules. That is, function <TT>Mod1.f</TT> calls
function <TT>Mod2.g</TT>, and function <TT>Mod2.g</TT> calls function <TT>Mod1.f</TT>.
In this case, no matter what permutations you perform on the command
line, the program will be rejected at link-time. Fixes:
</P><UL CLASS="itemize"><LI CLASS="li-itemize">
Put <TT>f</TT> and <TT>g</TT> in the same module.
</LI><LI CLASS="li-itemize">Parameterize one function by the other.
That is, instead of having
<PRE CLASS="verbatim">mod1.ml:    let f x = ... Mod2.g ...
mod2.ml:    let g y = ... Mod1.f ...
</PRE>define
<PRE CLASS="verbatim">mod1.ml:    let f g x = ... g ...
mod2.ml:    let rec g y = ... Mod1.f g ...
</PRE>and link <TT>mod1.cmo</TT> before <TT>mod2.cmo</TT>.
</LI><LI CLASS="li-itemize">Use a reference to hold one of the two functions, as in :
<PRE CLASS="verbatim">mod1.ml:    let forward_g =
                ref((fun x -&gt; failwith "forward_g") : &lt;type&gt;)
            let f x = ... !forward_g ...
mod2.ml:    let g y = ... Mod1.f ...
            let _ = Mod1.forward_g := g
</PRE></LI></UL></DD><DT CLASS="dt-description"><B>The external function <I>f</I> is not available</B></DT><DD CLASS="dd-description">
This error appears when trying to link code that calls external
functions written in C. As explained in
chapter <A HREF="manual032.html#c:intf-c">18</A>, such code must be linked with C libraries that
implement the required <I>f</I> C function. If the C libraries in
question are not shared libraries (DLLs), the code must be linked in
&#X201C;custom runtime&#X201D; mode. Fix: add the required C libraries to the
command line, and possibly the <TT>-custom</TT> option.</DD></DL><HR>
<A HREF="manual021.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A>
<A HREF="index.html"><IMG SRC="contents_motif.gif" ALT="Up"></A>
<A HREF="manual023.html"><IMG SRC="next_motif.gif" ALT="Next"></A>
</BODY>
</HTML>
